(function(_0x4ccaf7,_0x158d88){const _0x50b106=a0_0x1a49,_0x5cd2db=_0x4ccaf7();while(!![]){try{const _0x3c55f0=parseInt(_0x50b106(0x126))/0x1*(parseInt(_0x50b106(0x12a))/0x2)+-parseInt(_0x50b106(0x142))/0x3+-parseInt(_0x50b106(0x133))/0x4+parseInt(_0x50b106(0x12d))/0x5*(-parseInt(_0x50b106(0x143))/0x6)+parseInt(_0x50b106(0x13d))/0x7+parseInt(_0x50b106(0x11b))/0x8*(parseInt(_0x50b106(0x146))/0x9)+-parseInt(_0x50b106(0x131))/0xa*(-parseInt(_0x50b106(0x122))/0xb);if(_0x3c55f0===_0x158d88)break;else _0x5cd2db['push'](_0x5cd2db['shift']());}catch(_0x373dde){_0x5cd2db['push'](_0x5cd2db['shift']());}}}(a0_0x5212,0x52183));import{SignJWT,jwtVerify}from'jose';import a0_0x3d3f18 from'tweetnacl';import{renderLoginPage}from'../pages/login';function a0_0x1a49(_0x4e74dd,_0x11f657){const _0x5212d5=a0_0x5212();return a0_0x1a49=function(_0x1a4994,_0x2f0a35){_0x1a4994=_0x1a4994-0x11b;let _0x46c098=_0x5212d5[_0x1a4994];return _0x46c098;},a0_0x1a49(_0x4e74dd,_0x11f657);}async function generateJWTToken(_0x3b1af6,_0x1d6a2c){const _0x475f1e=a0_0x1a49,_0x16f7f4=await _0x3b1af6[_0x475f1e(0x121)](),_0x53a286=await _0x1d6a2c[_0x475f1e(0x139)]['get'](_0x475f1e(0x149));if(_0x16f7f4!==_0x53a286)return new Response(_0x475f1e(0x135),{'status':0x195});let _0x20cff2=await _0x1d6a2c[_0x475f1e(0x139)]['get'](_0x475f1e(0x12c));!_0x20cff2&&(_0x20cff2=generateSecretKey(),await _0x1d6a2c[_0x475f1e(0x139)][_0x475f1e(0x145)](_0x475f1e(0x12c),_0x20cff2));const _0x58340f=new TextEncoder()[_0x475f1e(0x141)](_0x20cff2),_0x52bdb2=await new SignJWT({'userID':globalThis['userID']})[_0x475f1e(0x144)]({'alg':_0x475f1e(0x13f)})[_0x475f1e(0x137)]()[_0x475f1e(0x130)](_0x475f1e(0x124))[_0x475f1e(0x129)](_0x58340f);return new Response('Success',{'status':0xc8,'headers':{'Set-Cookie':_0x475f1e(0x140)+_0x52bdb2+_0x475f1e(0x127)+0x7*0x18*0x3c*0x3c+_0x475f1e(0x13e),'Content-Type':_0x475f1e(0x12b)}});}function generateSecretKey(){const _0x96d119=a0_0x1a49,_0x2afd44=a0_0x3d3f18[_0x96d119(0x13c)](0x20);return Array[_0x96d119(0x138)](_0x2afd44,_0xa0d13e=>_0xa0d13e[_0x96d119(0x11f)](0x10)[_0x96d119(0x12f)](0x2,'0'))[_0x96d119(0x125)]('');}export async function Authenticate(_0xc52aca,_0x34f53f){const _0xed76e5=a0_0x1a49;try{const _0xd8b555=await _0x34f53f[_0xed76e5(0x139)][_0xed76e5(0x11e)](_0xed76e5(0x12c)),_0x8e6256=new TextEncoder()[_0xed76e5(0x141)](_0xd8b555),_0x121b1b=_0xc52aca[_0xed76e5(0x120)][_0xed76e5(0x11e)](_0xed76e5(0x147))?.[_0xed76e5(0x11d)](/(^|;\s*)jwtToken=([^;]*)/),_0x5efab2=_0x121b1b?_0x121b1b[0x2]:null;if(!_0x5efab2)return console[_0xed76e5(0x134)]('Unauthorized:\x20Token\x20not\x20available!'),![];const {payload:_0x4ac919}=await jwtVerify(_0x5efab2,_0x8e6256);return console[_0xed76e5(0x134)](_0xed76e5(0x12e)+_0x4ac919['userID']),!![];}catch(_0x1b483c){return console[_0xed76e5(0x134)](_0x1b483c),![];}}export function logout(){const _0x3797c0=a0_0x1a49;return new Response(_0x3797c0(0x13a),{'status':0xc8,'headers':{'Set-Cookie':_0x3797c0(0x136),'Content-Type':'text/plain'}});}export async function resetPassword(_0x28efee,_0x3f441b){const _0xff4267=a0_0x1a49;let _0x19aaa2=await Authenticate(_0x28efee,_0x3f441b);const _0x3a7ffb=await _0x3f441b[_0xff4267(0x139)][_0xff4267(0x11e)]('pwd');if(_0x3a7ffb&&!_0x19aaa2)return new Response('Unauthorized!',{'status':0x191});const _0x289c70=await _0x28efee[_0xff4267(0x121)]();if(_0x289c70===_0x3a7ffb)return new Response(_0xff4267(0x123),{'status':0x190});return await _0x3f441b['bpb'][_0xff4267(0x145)](_0xff4267(0x149),_0x289c70),new Response(_0xff4267(0x13a),{'status':0xc8,'headers':{'Set-Cookie':_0xff4267(0x11c),'Content-Type':_0xff4267(0x12b)}});}function a0_0x5212(){const _0x59a326=['padStart','setExpirationTime','90ulJatC','method','997544dMhtnB','log','Method\x20Not\x20Allowed','jwtToken=;\x20Secure;\x20SameSite=None;\x20Expires=Thu,\x2001\x20Jan\x201970\x2000:00:00\x20GMT','setIssuedAt','from','bpb','Success','redirect','randomBytes','3615983ITNEhb',';\x20Path=/;\x20SameSite=Strict','HS256','jwtToken=','encode','1896033NRJQqo','36yxQQKj','setProtectedHeader','put','984834xNgIai','Cookie','POST','pwd','24rhNyeS','jwtToken=;\x20Path=/;\x20Secure;\x20SameSite=None;\x20Expires=Thu,\x2001\x20Jan\x201970\x2000:00:00\x20GMT','match','get','toString','headers','text','361251GXcttb','Please\x20enter\x20a\x20new\x20Password!','24h','join','2QEQDEz',';\x20HttpOnly;\x20Secure;\x20Max-Age=','/panel','sign','668438mELzjq','text/plain','secretKey','492665tymMdC','Successfully\x20authenticated,\x20User\x20ID:\x20'];a0_0x5212=function(){return _0x59a326;};return a0_0x5212();}export async function login(_0x4ed1be,_0x528424){const _0x44315a=a0_0x1a49,_0x23bbaf=await Authenticate(_0x4ed1be,_0x528424);if(_0x23bbaf)return Response[_0x44315a(0x13b)](globalThis['urlOrigin']+_0x44315a(0x128),0x12e);if(_0x4ed1be[_0x44315a(0x132)]===_0x44315a(0x148))return await generateJWTToken(_0x4ed1be,_0x528424);return await renderLoginPage();}